# API Gateway 의 필요성

API Gateway는 서버 앞단에서 모든 API 서버들의 엔드포인트를 단일화 해주는 또다른 서버이다. API에 대한 인증과 인가 기능을 가지며, 메세지의 내용에 따라 어플리케이션 내부에 있는 마이크로 서비스로 라우팅해준다. 

주로 MSA 아키텍처에서 사용하고 있는데, 클라이언트에서 잘게 쪼개어진 여러개의 서비스를 각각 호출하다보면 다음과 같은 문제점이 발생한다. 
+ 각각의 서비스마다 인증/인가 등 공통된 로직을 구현해야 한다. 
+ 수많은 API 호출을 기록하고 관리하는 것이 어렵다. 
+ 내부의 비즈니스 로직이 드러나게 되어 보안에 취약하다. 

![image](https://user-images.githubusercontent.com/45115557/147713595-1bb0ca91-cd47-4bc1-bd1b-12433b2dc262.png)


# API Gateway 기능
### 1. 인증 및 인가(Authentication and Authorization) 

인증서 관리, 인증, SSL, 프로토콜 변환과 같은 기능들은 API Gateway에서 offload 함으로써 각각의 서비스 부담을 줄이고, 서비스의 관리 및 업그레이드를 쉽게 할 수 있다. 

### 2. 요청 절차 단순화

클라이언트에서 여러 서비스를 호출할 필요 없이 단일 요청으로 대체 가능하도록 해준다. 즉, 클라이언트와 백엔드 간의 API 통신량을 줄여주어 대기시간을 줄이고, 효율성을 높일 수 있다. 

### 3. 라우팅 및 로드밸런싱

API Gateway는 API 호출을 적절한 서비스에 라우팅 할 수 있다. 또한 서비스 인스턴스들에 대한 부하분산을 할 수 있다. 

### 4. 서비스 오케스트레이션

오스스트레이션이란 여러개의 마이크로 서비스를 묶어 새로운 서비스를 만드는 개념으로, 오케스트레이션 로직을 과도하게 넣는 것은 API Gateway의 부담을 늘리는 것이다. 따라서 MSA 와 API Gateway에 대한 높은 수준의 기술적 이해를 바탕으로 이루어져야 한다. 

### 5. 서비스 디스커버리

API Gateway는 각 서비스를 호출하기 위해 서비스마다 IP주소와 포트번호를 알고 있어야 한다. 고정적인 IP주소를 가지는 경우에는 문제될 것이 없지만 클라우드 환경에서는 동적인 환경에서 배포되기 때문에 서비스의 위치를 찾는 것이 어렵다. 이러한 서비스의 위치 (IP주소와 포트번호)를 찾는 것을 'Service Discovery' 라고 하며 API Gateway에서는 서버사이드나 클라이언트사이드를 기준으로 하여 서비스 디스커버리를 구현할 수 있다. 


# API Gateway 적용시 고려사항

1. API Gateway의 Scale-out 적용이 유연하게 일어나지 않을 경우, 병목지점이 되어 어플리케이션 성능저하가 일어날 수 있다. 
2. 추가적인 계층이 만들어지는 것이기 때문에 네트워크 latency가 발생할 수 있다. 










참고 링크:
https://velog.io/@tedigom/MSA-%EC%A0%9C%EB%8C%80%EB%A1%9C-%EC%9D%B4%ED%95%B4%ED%95%98%EA%B8%B0-3API-Gateway-nvk2kf0zbj
